{% extends 'base.html' %}
{% block title %}Deployment管理{% endblock %}
{% block content %}
<div class="card">
    <h2 class="card-title">Deployment 管理</h2>
    <div style="margin-bottom: 2rem;">
        <label>选择命名空间：</label>
        <select onchange="location.href='?namespace='+this.value" style="padding: 0.5rem; border-radius: 6px; border: 2px solid #e0e0e0;">
            {% for ns in namespaces %}
            <option value="{{ ns.metadata.name }}" {% if ns.metadata.name == current_namespace %}selected{% endif %}>
                {{ ns.metadata.name }}
            </option>
            {% endfor %}
        </select>
    </div>
    <table>
        <thead>
            <tr>
                <th>名称</th>
                <th>副本数</th>
                <th>可用副本</th>
                <th>镜像</th>
                <th>创建时间</th>
                <th>操作</th>
            </tr>
        </thead>
        <tbody>
            {% for deploy in deployments %}
            <tr>
                <td><strong>{{ deploy.metadata.name }}</strong></td>
                <td>{{ deploy.spec.replicas }}</td>
                <td>{{ deploy.status.available_replicas|default:"0" }}</td>
                <td>{{ deploy.spec.template.spec.containers.0.image }}</td>
                <td>{{ deploy.metadata.creation_timestamp|date:"Y-m-d H:i:s" }}</td>
                <td>
                    <a href="/deployments/delete/{{ current_namespace }}/{{ deploy.metadata.name }}/" 
                       class="btn btn-danger" onclick="return confirm('确认删除?')">删除</a>
                </td>
            </tr>
            {% empty %}
            <tr><td colspan="6" style="text-align: center; color: #999;">暂无数据</td></tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% endblock %}
