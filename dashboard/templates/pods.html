{% extends 'base.html' %}
{% block title %}Pod管理{% endblock %}
{% block content %}
<div class="card">
    <h2 class="card-title">Pod 管理</h2>
    <div style="margin-bottom: 2rem;">
        <label>选择命名空间：</label>
        <select onchange="location.href='?namespace='+this.value" style="padding: 0.5rem; border-radius: 6px; border: 2px solid #e0e0e0;">
            {% for ns in namespaces %}
            <option value="{{ ns.metadata.name }}" {% if ns.metadata.name == current_namespace %}selected{% endif %}>
                {{ ns.metadata.name }}
            </option>
            {% endfor %}
        </select>
    </div>
    <table>
        <thead>
            <tr>
                <th>名称</th>
                <th>状态</th>
                <th>IP</th>
                <th>节点</th>
                <th>重启次数</th>
                <th>创建时间</th>
                <th>操作</th>
            </tr>
        </thead>
        <tbody>
            {% for pod in pods %}
            <tr>
                <td><strong>{{ pod.metadata.name }}</strong></td>
                <td>
                    <span class="status-badge {% if pod.status.phase == 'Running' %}status-running{% elif pod.status.phase == 'Pending' %}status-pending{% else %}status-failed{% endif %}">
                        {{ pod.status.phase }}
                    </span>
                </td>
                <td>{{ pod.status.pod_ip|default:"-" }}</td>
                <td>{{ pod.spec.node_name|default:"-" }}</td>
                <td>{{ pod.status.container_statuses.0.restart_count|default:"0" }}</td>
                <td>{{ pod.metadata.creation_timestamp|date:"Y-m-d H:i:s" }}</td>
                <td>
                    <a href="/pods/delete/{{ current_namespace }}/{{ pod.metadata.name }}/" 
                       class="btn btn-danger" onclick="return confirm('确认删除?')">删除</a>
                </td>
            </tr>
            {% empty %}
            <tr><td colspan="7" style="text-align: center; color: #999;">暂无数据</td></tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% endblock %}
